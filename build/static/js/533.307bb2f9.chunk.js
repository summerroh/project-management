"use strict";(self.webpackChunkoctavia_combine=self.webpackChunkoctavia_combine||[]).push([[533],{1702:(e,t,i)=>{i.d(t,{Z:()=>u});var s=i(3967),o=i(5193),n=i(4554),r=i(8082),l=i(8492),a=i(2791),c=i(5717),d=i(184);function u(e){let{images:t}=e;const i=(0,s.Z)(),u=(0,o.Z)(i.breakpoints.down("sm")),p=(0,a.useRef)(null),[h,g]=(0,a.useState)(0),x={dots:!1,infinite:t.length>1,speed:500,slidesToShow:1,slidesToScroll:1,afterChange:e=>g(e),initialSlide:h,arrows:t.length>1,nextArrow:t.length>1?(0,d.jsx)(m,{}):null,prevArrow:t.length>1?(0,d.jsx)(b,{}):null},f={position:"absolute",top:"50%",transform:"translateY(-50%)",zIndex:1,cursor:"pointer",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",width:"34px",height:"34px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}};function m(e){const{onClick:t}=e;return(0,d.jsx)(n.Z,{onClick:t,sx:{...f,right:"10px"},children:(0,d.jsx)(r.Z,{size:20})})}function b(e){const{onClick:t}=e;return(0,d.jsx)(n.Z,{onClick:t,sx:{...f,left:"10px"},children:(0,d.jsx)(l.Z,{size:20})})}return(0,d.jsxs)(n.Z,{sx:{width:"100%",marginTop:2,marginBottom:2},children:[(0,d.jsxs)(n.Z,{sx:{position:"relative"},children:[1===t.length?(0,d.jsx)("div",{children:(0,d.jsx)("img",{src:t[0].path,alt:"Single image",style:{width:"100%",height:"auto",maxHeight:"500px",objectFit:"contain",borderRadius:u?"0":"10px",outline:"none"}})}):(0,d.jsx)(c.Z,{ref:p,...x,children:t.map(((e,t)=>(0,d.jsx)("div",{children:(0,d.jsx)("img",{src:e.path,alt:`Image ${t+1}`,style:{width:"100%",height:"auto",maxHeight:"500px",objectFit:"contain",borderRadius:u?"0":"10px",outline:"none"}})},t)))}),t.length>1&&(0,d.jsxs)(n.Z,{sx:{position:"absolute",bottom:14,right:10,backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 10px",borderRadius:"15px",fontSize:"14px"},children:[h+1,"/",t.length]})]}),!u&&t.length>1&&(0,d.jsx)(n.Z,{mt:2,gap:1,display:"flex",justifyContent:"flex-start",children:t.map(((e,t)=>(0,d.jsx)(n.Z,{onClick:()=>{p.current.slickGoTo(t),g(t)},sx:{width:"100px",height:"100px",cursor:"pointer",border:h===t?`2px solid ${i.palette.primary.main}`:"none",borderRadius:"5px",overflow:"hidden",position:"relative","&::after":{content:'""',position:"absolute",top:0,left:0,width:"100px",height:"100%",backgroundColor:h===t?"rgba(0, 0, 0, 0.5)":"transparent",transition:"background-color 0.3s"}},children:(0,d.jsx)("img",{src:e.path,alt:`Thumbnail ${t+1}`,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover"}})},t)))})]})}},533:(e,t,i)=>{i.r(t),i.d(t,{default:()=>de});var s=i(3967),o=i(5193),n=i(4554),r=i(1153),l=i(761),a=i(5363),c=i(7133),d=i(8970),u=i(5801),p=i(5639),h=i(4721),g=i(9234),x=i(4326),f=i(3874),m=i(8464),b=i(7711),j=i(3513),k=i(6366),v=i(8847),C=i(6198),Z=i(1984),y=i(2266),w=i(3916),A=i(3406),F=i(3441),S=i(5482),z=i(3846),E=i(8036),B=i(8489),N=i(3327),P=i(4134),R=i(5305),T=i(89),I=i(2390),O=i(8898),L=i(6567),W=i(174),_=i(8807),H=i(8287),D=i(7417),M=i(6088),U=i(2791),$=i(7689),V=i(8591),q=i(184);function G(e){let{color:t,onChange:i}=e;const n=(0,s.Z)(),r=(0,o.Z)(n.breakpoints.down("sm"));return(0,q.jsx)("div",{style:{position:"fixed",top:"200px",left:r?"20px":"auto",zIndex:1e3,background:"white",padding:"10px",boxShadow:"0 0 10px rgba(0,0,0,0.1)",borderRadius:"5px"},onClick:e=>{e.stopPropagation()},children:(0,q.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:"5px"},children:["#151515","#787878","#C2C2C2","#EEEEEE","#FFFFFF","#FECCBE","#FEEFC5","#E4F0D5","#B8E9FF","#E0BFE6","#FD8A69","#FFCD4A","#AFD485","#58CCFF","#B96BC6","#FC5230","#FD9F28","#7DB249","#18A8F1","#9A30AE","#D94925","#FD6F22","#568A35","#1187CF","#692498"].map(((e,t)=>(0,q.jsx)("div",{style:{width:"25px",height:"25px",backgroundColor:e,borderRadius:"5px",cursor:"pointer"},onClick:()=>{i(e)}},t)))})})}var K=i(4701),J=i(139),Y=i(2626),Q=i(9624);function X(e){let{items:t,width:i,height:o,backgroundColor:n,placeholder:r,onSelect:l,defaultValue:a=""}=e;const[c,d]=(0,U.useState)(a),u=(0,s.Z)();return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(K.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:c,onChange:e=>{d(e.target.value),l(e.target.value)},displayEmpty:!0,renderValue:e=>0===e.length?(0,q.jsx)(Q.x4,{sx:{fontSize:14,color:u.palette.primary.dark,paddingRight:0},children:r}):(0,q.jsx)("span",{style:{paddingRight:0},children:e}),MenuProps:{MenuListProps:{style:{padding:"0",margin:"0"}}},input:(0,q.jsx)(J.ZP,{sx:{height:o||40,fontSize:14,textAlign:"left",paddingLeft:"10px !important",display:"flex",justifyContent:"flex-start",borderRadius:"8px",color:u.palette.primary.dark,backgroundColor:n||"#ffffff",marginBottom:0,border:"none","& .MuiPopover-paper":{boxShadow:"none"},"& .MuiInputBase-input":{paddingRight:"0 !important"}}}),IconComponent:()=>null,children:t.map((e=>(0,q.jsx)(Y.Z,{sx:{height:o||40,fontSize:14,fontWeight:300,border:"1px solid #E1E1E1"},value:e,children:e})))})})}var ee=i(6578),te=i(7303),ie=(i(5717),i(8366)),se=i(1702),oe=i(6749);const ne=24,re=e=>{let{onFileUpload:t,isEditing:i,articleData:o}=e;const r=(0,$.s0)(),{t:l}=(0,ie.$G)(),g=(0,s.Z)(),[x,f]=(0,U.useState)("#ffc078"),[m,b]=(0,U.useState)(!1),[j,k]=(0,U.useState)("#ffc078"),[v,C]=(0,U.useState)(!1),[Z,y]=(0,U.useState)(""),[w,A]=(0,U.useState)("sell"),[S,M]=(0,U.useState)("korean"),[V,K]=(0,U.useState)(""),[J,Y]=(0,U.useState)([]),[Q,re]=(0,U.useState)([]),[le,ae]=(0,U.useState)(!1),{editor:ce}=(0,F.fi)();(0,U.useEffect)((()=>{i&&o&&(K(o.title),A(o.type),M(o.language),re(o.images||[]),Y(o.imageIds||[]),ce.commands.setContent(o.content))}),[i,o]);(0,U.useEffect)((()=>{y((()=>{const{from:e,to:t}=ce.state.selection;return ce.state.doc.textBetween(e,t," ")})())}),[ce.state.selection,y]);const de=["12px","14px","16px","18px","20px","24px","28px","32px","36px","48px"],ue=["Pretendard","Noto Sans KR"];return ce?(0,q.jsxs)(q.Fragment,{children:[le&&(0,q.jsx)(oe.Z,{}),(0,q.jsxs)(n.Z,{className:"control-group",children:[(0,q.jsxs)(n.Z,{className:"button-group",style:{justifyContent:"space-between",alignItems:"center",paddingRight:"10px",paddingLeft:"10px"},children:[(0,q.jsxs)(a.Z,{component:"fieldset",style:{paddingLeft:"10px",paddingTop:"10px"},children:[(0,q.jsx)(c.Z,{sx:{fontSize:"0.9rem",color:g.palette.primary.dark},children:l("editor.post_type.label")}),(0,q.jsxs)(d.Z,{row:!0,"aria-label":"post-type",name:"post-type",value:w,onChange:e=>{A(e.target.value)},children:[(0,q.jsx)(u.Z,{value:"sell",control:(0,q.jsx)(p.Z,{size:"small"}),label:l("editor.post_type.sell")}),(0,q.jsx)(u.Z,{value:"buy",control:(0,q.jsx)(p.Z,{size:"small"}),label:l("editor.post_type.buy")})]})]}),(0,q.jsxs)(a.Z,{component:"fieldset",style:{paddingLeft:"10px",paddingTop:"10px"},children:[(0,q.jsx)(c.Z,{sx:{fontSize:"0.9rem",color:g.palette.primary.dark},children:l("editor.language.label")}),(0,q.jsxs)(d.Z,{row:!0,"aria-label":"language",name:"language",value:S,onChange:e=>{M(e.target.value)},children:[(0,q.jsx)(u.Z,{value:"korean",control:(0,q.jsx)(p.Z,{size:"small"}),label:l("editor.language.korean")}),(0,q.jsx)(u.Z,{value:"japanese",control:(0,q.jsx)(p.Z,{size:"small"}),label:l("editor.language.japanese")}),(0,q.jsx)(u.Z,{value:"english",control:(0,q.jsx)(p.Z,{size:"small"}),label:l("editor.language.english")})]})]}),(0,q.jsx)(n.Z,{onClick:async()=>{try{const e=i?`http://localhost:4000/article/${o._id}`:"http://localhost:4000/article/write",t=i?"PUT":"POST",s=await fetch(e,{method:t,credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:w,language:S,title:V,content:ce.getHTML(),imageIds:J})});if(!s.ok){throw await s.json()}te.Am.success(l(i?"toast.edit_success":"toast.create_success"),{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),r("/forum")}catch(e){console.error("Error:",e),403===e.response.status?(te.Am.error(l("login_required"),{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),r("/login")):"Articles validation failed: title: Path `title` is required."===e.error?(console.log("\uc81c\ubaa9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694."),te.Am.error(l("title_required"),{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0})):te.Am.error(l("error"),{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}},variant:"contained",sx:{cursor:"pointer",padding:"0px 20px",height:"40px",borderRadius:"10px",border:"1px solid #e1e1e1 !important",color:"white",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:g.palette.primary.darkBlue,"&:hover":{backgroundColor:g.palette.primary.darkBlueHover}},children:l(i?"editor.buttons.update":"editor.buttons.publish")})]}),(0,q.jsxs)("div",{className:"button-group",style:{justifyContent:"space-between",paddingRight:"14px",paddingLeft:"14px"},children:[(0,q.jsx)("button",{onClick:()=>ce.chain().focus().undo().run(),disabled:!ce.can().chain().focus().undo().run(),children:(0,q.jsx)(z.Z,{size:ne,strokeWidth:1})}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().redo().run(),disabled:!ce.can().chain().focus().redo().run(),children:(0,q.jsx)(E.Z,{size:ne,strokeWidth:1})}),(0,q.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(Z).then((()=>console.log("Text copied successfully"))).catch((e=>console.error("Failed to copy:",e)))},children:[(0,q.jsx)(B.Z,{size:ne,strokeWidth:1}),l("editor.buttons.copy")]}),(0,q.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files[0];if(t){ae(!0);const e=new FormData;e.append("image",t);try{const t=await fetch("http://localhost:4000/upload/image",{method:"POST",credentials:"include",body:e});if(!t.ok)throw new Error("Upload failed");const i=await t.json();Y((e=>[...e,i.imageId])),re((e=>[...e,{path:i.imageUrl}]))}catch(i){console.error("Error uploading image:",i),te.Am.error(l("image_upload_error"),{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{ae(!1)}}},style:{display:"none"},id:"image-upload"}),(0,q.jsxs)("label",{htmlFor:"image-upload",className:"button",children:[(0,q.jsx)(N.Z,{size:ne,strokeWidth:1}),l("editor.buttons.photo")]}),(0,q.jsx)("input",{type:"file",onChange:e=>{const i=e.target.files[0];i&&t(i)},style:{display:"none"},id:"file-upload"}),(0,q.jsxs)("label",{htmlFor:"file-upload",className:"button",children:[(0,q.jsx)(P.Z,{size:ne,strokeWidth:1}),l("editor.buttons.file")]}),(0,q.jsxs)("button",{onClick:()=>(()=>{const e=ce.getAttributes("link").href,t=window.prompt("URL\uc744 \uc785\ub825\ud558\uc138\uc694",e);null!==t&&(""!==t?ce.chain().focus().extendMarkRange("link").setLink({href:t}).run():ce.chain().focus().extendMarkRange("link").unsetLink().run())})(),className:ce.isActive("link")?"is-active":"",children:[(0,q.jsx)(R.Z,{size:ne,strokeWidth:1}),l("editor.buttons.link")]}),(0,q.jsxs)("button",{onClick:()=>ce.chain().focus().unsetLink().run(),disabled:!ce.isActive("link"),children:[(0,q.jsx)(T.Z,{size:ne,strokeWidth:1}),l("editor.buttons.unlink")]}),(0,q.jsxs)("button",{onClick:()=>ce.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run(),children:[(0,q.jsx)(I.Z,{size:ne,strokeWidth:1}),l("editor.buttons.table")]}),(0,q.jsxs)("button",{onClick:()=>ce.chain().focus().toggleBulletList().run(),className:ce.isActive("bulletList")?"is-active":"",children:[(0,q.jsx)(O.Z,{size:ne,strokeWidth:1}),l("editor.buttons.list1")]}),(0,q.jsxs)("button",{onClick:()=>ce.chain().focus().toggleOrderedList().run(),className:ce.isActive("orderedList")?"is-active":"",children:[(0,q.jsx)(L.Z,{size:ne,strokeWidth:1}),l("editor.buttons.list2")]}),(0,q.jsx)(n.Z,{children:(0,q.jsx)(X,{items:["\xa9","\xae","\u2122","\u2713","\u2717","\u2605","\u2606","\u2665","\u2666","\u2663","\u2660"],onSelect:e=>{ce.chain().focus().insertContent(e).run()},width:"70px",height:"40px",placeholder:l("editor.buttons.special_char")})})]}),(0,q.jsxs)("div",{className:"button-group",children:[(0,q.jsx)(X,{defaultValue:ue[0],items:ue,onSelect:e=>{ce.chain().focus().setFontFamily(e).run()},width:"140px",height:"40px",placeholder:"Font Family"}),(0,q.jsx)(X,{defaultValue:de[0],items:de,onSelect:e=>{ce.chain().focus().setFontSize(e).run()},width:"80px",height:"40px",placeholder:"Font Size"}),(0,q.jsx)(h.Z,{orientation:"vertical",flexItem:!0,sx:{margin:"10px 10px"}}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().toggleBold().run(),disabled:!ce.can().chain().focus().toggleBold().run(),className:ce.isActive("bold")?"is-active":"",children:(0,q.jsx)("img",{src:"/static/editor/bold.svg",alt:"bold"})}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().toggleItalic().run(),disabled:!ce.can().chain().focus().toggleItalic().run(),className:ce.isActive("italic")?"is-active":"",children:(0,q.jsx)("img",{src:"/static/editor/italic.svg",alt:"italic"})}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().toggleStrike().run(),disabled:!ce.can().chain().focus().toggleStrike().run(),className:ce.isActive("strike")?"is-active":"",children:(0,q.jsx)("img",{src:"/static/editor/strike.svg",alt:"strike"})}),(0,q.jsxs)("button",{onClick:()=>b(!m),className:ce.isActive("highlight")?"is-active":"",style:{position:"relative"},children:[(0,q.jsx)("img",{src:"/static/editor/highlight.svg",alt:"highlight"}),m&&(0,q.jsx)(G,{color:x,onChange:e=>{f(e),ce.chain().focus().toggleHighlight({color:e}).run()}})]}),(0,q.jsxs)("button",{onClick:()=>C(!v),className:ce.isActive("textStyle",{color:j})?"is-active":"",style:{position:"relative"},children:[(0,q.jsx)("img",{src:"/static/editor/textColor.svg",alt:"textColor"}),v&&(0,q.jsx)(G,{color:j,onChange:e=>{k(e),ce.chain().focus().setColor(e).run()}})]}),(0,q.jsx)(h.Z,{orientation:"vertical",flexItem:!0,sx:{margin:"10px 10px"}}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().setTextAlign("left").run(),className:ce.isActive({textAlign:"left"})?"is-active":"",children:(0,q.jsx)(W.Z,{size:ne,strokeWidth:1})}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().setTextAlign("center").run(),className:ce.isActive({textAlign:"center"})?"is-active":"",children:(0,q.jsx)(_.Z,{size:ne,strokeWidth:1})}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().setTextAlign("right").run(),className:ce.isActive({textAlign:"right"})?"is-active":"",children:(0,q.jsx)(H.Z,{size:ne,strokeWidth:1})}),(0,q.jsx)("button",{onClick:()=>ce.chain().focus().setTextAlign("justify").run(),className:ce.isActive({textAlign:"justify"})?"is-active":"",children:(0,q.jsx)(D.Z,{size:ne,strokeWidth:1})})]}),(0,q.jsx)(ee.Z,{placeholder:l("editor.title.placeholder"),value:V,onChange:e=>K(e.target.value),sx:{backgroundColor:"white",borderRadius:"0px",border:"none",borderBottom:"1px solid #e1e1e1","& .MuiOutlinedInput-notchedOutline":{border:"none"}}}),Q.length>0&&(0,q.jsx)(se.Z,{images:Q})]})]}):null},le=[g.I.configure({types:[A.Z.name,k.Z.name]}),A.Z.configure({types:[k.Z.name]}),S.Z.configure({bulletList:{keepMarks:!0,keepAttributes:!1},orderedList:{keepMarks:!0,keepAttributes:!1}}),b.ZP,x.Z,v.ZP.configure({resizable:!0}),y.Z,Z.Z,C.Z,m.ZP.configure({multicolor:!0}),V.Z.configure(),w.Z.configure({types:["heading","paragraph"]}),f.Z.configure(),j.ZP.configure({openOnClick:!0,linkOnPaste:!0,autolink:!0,defaultProtocol:"https",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer"}})];function ae(e){let{isEditing:t=!1,articleData:i=null}=e;const{t:s}=(0,ie.$G)(),[o,n]=(0,U.useState)([]),r=s("editor.content.placeholder");return(0,q.jsxs)("div",{children:[(0,q.jsx)(F.KU,{slotBefore:(0,q.jsx)(re,{onFileUpload:e=>{n((t=>[...t,e]))},isEditing:t,articleData:i}),extensions:le,content:r}),o.length>0&&(0,q.jsxs)("div",{className:"uploaded-files-container",children:[(0,q.jsx)("h5",{style:{marginBottom:"12px"},children:s("editor.uploaded_files.title")}),(0,q.jsx)("div",{className:"file-list",children:o.map(((e,t)=>(0,q.jsxs)("div",{className:"file-item",children:[(0,q.jsx)("span",{className:"file-name",children:e.name}),(0,q.jsx)("button",{className:"remove-file",onClick:()=>{return e=t,void n((t=>t.filter(((t,i)=>i!==e))));var e},children:(0,q.jsx)(M.Z,{size:16})})]},t)))})]})]})}var ce=i(1243);function de(){var e;const{isLoggedIn:t}=(0,l.a)(),i=(0,$.s0)(),a=(0,$.TH)(),[c,d]=(0,U.useState)(null),[u,p]=(0,U.useState)(!1),[h,g]=(0,U.useState)(null),x=null===(e=a.state)||void 0===e?void 0:e.articleId,f=Boolean(x),m=(0,s.Z)(),b=((0,o.Z)(m.breakpoints.down("sm")),(0,o.Z)(m.breakpoints.down("lg"))),j=(0,o.Z)(m.breakpoints.down("lg")),k=(0,U.useRef)(!1);return(0,U.useEffect)((()=>{x&&(async()=>{p(!0);try{const{data:e}=await ce.Z.get(`http://localhost:4000/article/${x}`,{withCredentials:!0});d(e),g(null)}catch(t){var e;g((null===(e=t.response)||void 0===e?void 0:e.data)||"An error occurred"),console.error("Error fetching article:",t),te.Am.error("\uac8c\uc2dc\uae00\uc744 \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),i("/forum")}finally{p(!1)}})()}),[x,i]),(0,U.useEffect)((()=>{if(!t&&!k.current)return te.Am.error("\ub85c\uadf8\uc778 \ud6c4 \uc774\uc6a9\ud574\uc8fc\uc138\uc694.",{position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),k.current=!0,void i("/login")}),[t,i]),(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(n.Z,{my:b?0:6,sx:{width:j?"100%":"1100px"},children:(0,q.jsx)(r.ZP,{container:!0,width:"100%",alignItems:"center",justifyContent:"center",children:(0,q.jsx)(r.ZP,{item:!0,xs:12,bgcolor:"white",borderRadius:"10px",children:u?(0,q.jsx)(oe.Z,{}):(0,q.jsx)(ae,{isEditing:f,articleData:c})})})})})}}}]);
//# sourceMappingURL=533.307bb2f9.chunk.js.map